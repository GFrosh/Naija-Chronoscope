<!-- README for LagosPen -->
# LagosPen

LagosPen is a small CMS / content website for a journalist (Esther Onyegbula). It serves a static client site and an admin area for creating and managing articles, backed by a SQLite database and a small Express server.

## Tech stack
- Node.js + Express
- SQLite (better-sqlite3)
- JWT authentication (cookie-based)
- bcryptjs for password hashing
- Static frontends: `client/`, `admin/`, `login/` (HTML/CSS/JS)

## Quickstart (PowerShell)

1. Install dependencies

```powershell
cd 'c:\Users\USER\Documents\LagosPen'
npm install
```

2. Create environment variables

Create a `.env` file in the `server` folder (the server loads `server/.env`) with at least:

```
PORT=3000
JWT_SECRET=your_long_random_secret_here
```

3. Start the server (development)

```powershell
npm run dev
```

4. Open in your browser

- Public site: http://localhost:3000/
- Login: http://localhost:3000/login
- Admin (after login): http://localhost:3000/admin

## Project layout (important parts)

- `server/server.js` - main Express server and routes
- `server/db.js` - SQLite setup using `better-sqlite3` (auto-creates tables)
- `server/data/Database.db` - runtime SQLite DB file (created automatically)
- `client/` - public site static files
- `admin/` - admin UI (served under `/admin`, protected by JWT cookie)
- `login/` - login UI (serves POST `/login`)

## Important endpoints

- POST `/login` - authenticate user; sets JWT cookie
- POST `/logout` - clears cookie
- GET `/api/articles` - returns all articles (JSON)
- GET `/api/articles/:id` - returns article by id
- POST `/articles` - create a new article (admin)
- GET `/users` and `/users/:admin` - admin user queries
- GET `/media` - returns media records

Notes: The admin static route is protected by `authenticateToken` middleware in `server/server.js`. You must log in to access `/admin` files.

## Environment & security notes
- `server/.env` must contain `JWT_SECRET` and `PORT`. If `JWT_SECRET` is missing, auth will fail.
- Cookies are set with `httpOnly: true` but `secure: false` (suitable for local dev). For production, set `secure: true` and serve over HTTPS.
- Consider enabling and configuring `helmet` (already listed in deps) and adding input validation for article creation and login requests.

## Local development tips
- On first run the DB file and tables are created automatically.
- There are commented sample inserts in `server/db.js` you can use to bootstrap admin users (uncomment carefully).

## Recommended next steps (prioritized)
1. Add a simple health-check endpoint (GET `/health`) and a small smoke test to verify the server starts correctly.
2. Add server-side validation for POST `/articles` (required fields, length checks) and return proper 400 responses.
3. Make cookie `secure` configurable via an environment variable (eg. `COOKIE_SECURE=true` for production).
4. Configure `helmet` for security headers and add a CORS policy if remote clients will call the API.
5. Add automated tests (Jest or Mocha) for the login flow and the articles API; and add a CI workflow.
6. Consider migrating from SQLite to Postgres/MySQL if you need concurrency or remote hosting.

## Way forward (suggestion)
Start with (1) health-check + smoke test and (2) server-side validation â€” both are small, low-risk, and improve reliability. After that, add a CI job that runs tests on push.

If you'd like, I can implement the health-check endpoint and a small smoke test now. Which should I do next?

---
Generated by a repository scan on Nov 22, 2025.
